<div class="container">
  <form action="/exploits/" method="post">
    {% csrf_token %}
    <div class="form-row">
      <div class="form-group col">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-globe-europe"></i>
            </span>
          </div>
          <input
            type="text"
            name="url"
            class="form-control"
            placeholder="Enter website address"
            required
          />
        </div>
      </div>
      <div class="form-group col">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-list"></i>
            </span>
          </div>
          <select
            name="attack_type"
            id="attack_type"
            class="form-control"
            required
          >
            <option disabled selected value="">Choose attack type</option>
            <option value="default">Default</option>
            <option value="custom">Custom</option>
          </select>
        </div>
      </div>
      <div class="form-group col">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-file-code"></i>
            </span>
          </div>
          <input
            type="text"
            name="custom_code"
            id="custom_code"
            class="form-control"
            placeholder="Paste custom code here"
            readonly
          />
        </div>
      </div>
      <div class="form-group col-auto">
        <button
          class="btn btn-primary launch"
          type="submit"
          name="sqli"
          value="1"
        >
          Launch
        </button>
      </div>
    </div>
  </form>
  <div class="response">
    {% if response %}
    <h3>Output</h3>
    <p>
      Target website:
      <a href="{{response.target_url}}" target="_blank" rel="norefferer">
        {{response.target_url}}
      </a>
    </p>
    <p>Mode: {{response.attack_mode}}</p>
    <p>
      Tried statements: {{response.tried_strings_number}}
      ({{response.successful_injections_number}} succeeded)
    </p>
    {% if response.status %}
    <p>Status: <span class="text-success strong">vulnerable</span></p>
    <p>
      Summary: SQLi was detected. Website is vulnerable to Cross-site script.
    </p>
    <button
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#collapseExample"
      aria-expanded="false"
      aria-controls="collapseExample"
    >
      Show details
    </button>
    <div class="collapse details" id="collapseExample">
      <div class="card card-body">
        <h4>String query:</h4>
        <pre>{{response.successful_strings}}</pre>
      </div>
    </div>
    {% else %}
    <p>Status: <span class="text-danger strong">not vulnerable</span>.</p>
    <p>
      Summary: SQLi was not detected. Website is not vulnerable to SQL
      Injection.
    </p>
    {% endif %} {% else %}
    <h3>How to use SQL Injection (SQLi)</h3>
    <ol>
      <li>Enter the full URL (incl. http/https)</li>
      <li>
        Choose mode
        <ul>
          <li>Default - the standard statement will be used</li>
          <li>Custom - inject your own statement</li>
        </ul>
      </li>
      <li>Launch SQLi</li>
    </ol>
    {% endif %}
  </div>
</div>
