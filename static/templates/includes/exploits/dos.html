<div class="container">
  <form action="/exploits/" method="post">
    {% csrf_token %}
    <div class="form-row">
      <div class="form-group col-lg col-md-12 col-sm-12">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-globe-europe"></i>
            </span>
          </div>
          <input
            type="text"
            name="host"
            class="form-control"
            placeholder="Host"
            required
          />
        </div>
      </div>
      <div class="form-group col-lg col-md-6 col-sm-12">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-list"></i>
            </span>
          </div>
          <select
            name="attack_type"
            id="attack_type"
            class="form-control"
            required
          >
            <option disabled selected value="">Choose mode</option>
            <option value="http-flood">Slow HTTP attack</option>
          </select>
        </div>
      </div>
      <div class="form-group col-lg-2 col-md-6 col-sm">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-passport"></i>
            </span>
          </div>
          <input
            type="text"
            name="port"
            id="port"
            class="form-control"
            placeholder="Port"
          />
        </div>
      </div>
      <div class="form-group col-lg col-md-6 col-sm">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-sort-numeric-up-alt"></i>
            </span>
          </div>
          <input
            type="text"
            name="socket_limit"
            id="socket_limit"
            class="form-control"
            placeholder="Socket limit"
          />
        </div>
      </div>
      <div class="form-group col-lg ccol-md-6 col-sm">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-lock"></i>
            </span>
          </div>
          <select name="is_https" id="is_https" class="form-control" required>
            <option disabled selected value="">Enable HTTPS</option>
            <option value="False">No</option>
            <option value="True">Yes</option>
          </select>
        </div>
      </div>
      <div class="form-group col col-sm-auto">
        <button
          class="btn btn-primary launch"
          id="launch"
          type="submit"
          name="dos"
          value="1"
        >
          <span id="searchIcon">Launch</span>
        </button>
      </div>
    </div>
  </form>
  <div class="response">
    {% if response.error %}
    <h3>Output</h3>
    <p class="text-danger">{{response.description}}</p>
    {% elif response %}
    <h3>Output</h3>
    <p>
      Target website:
      <a href="{{response.target_url}}" target="_blank" rel="noreferrer">
        {{response.target_url}}
      </a>
    </p>
    <p>Port: {{response.port}}</p>
    <p>Mode: {{response.attack_type}}</p>
    <p>HTTPS: {% if response.https %}Yes{% else %}No{% endif %}</p>
    <p>
      Service available: {% if response.available %}
      <span class="text-success strong">Yes</span>
      {% else %}
      <span class="text-danger strong">No</span>
      {% endif %}
    </p>
    <button
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#log"
      aria-expanded="false"
      aria-controls="collapseExample"
    >
      Show details
    </button>
    <div class="collapse details" id="log">
      <div class="card card-body">
        <h4>Log:</h4>
        <ul>
          {% for line in response.log %}
          <li>{{line}}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% else %}
    <h3>How to use Denial of Service (DoS)</h3>
    <ol>
      <li>Enter the full URL (incl. http/https)</li>
      <li>
        Choose mode
        <ul>
          <li>
            Slow HTTP attack - periodically sending HTTP headers, keeping
            connections open and denying additional connection attempts from
            clients
          </li>
        </ul>
      </li>
      <li>Enter port (default: 80)</li>
      <li>Enter maximum number of sockets per request (default: 200)</li>
      <li>Enable HTTPS (default: disabled)</li>
      <li>Launch DoS</li>
    </ol>
    <p>
      Note: The most affected web server are Apache 1.x, Apache 2.x and Flask
    </p>
    {% endif %}
  </div>
</div>
