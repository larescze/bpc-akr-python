<div class="container">
  <form action="/exploits/" method="post">
    {% csrf_token %}
    <div class="form-row">
      <div class="form-group col-lg col-md-12 col-sm-12">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-globe-europe"></i>
            </span>
          </div>
          <input
            type="text"
            name="url"
            class="form-control"
            placeholder="Enter website address"
            required
          />
        </div>
      </div>
      <div class="form-group col-lg col-md-6 col-sm-12">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-list"></i>
            </span>
          </div>
          <select
            name="attack_type"
            id="attack_type"
            class="form-control"
            required
          >
            <option disabled selected value="">Choose mode</option>
            <option value="full_scan">Full scan</option>
            <option value="custom">Custom file finder</option>
          </select>
        </div>
      </div>
      <div class="form-group col-lg col-md-6 col-sm">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">
              <i class="fas fa-file-alt"></i>
            </span>
          </div>
          <input
            type="text"
            name="custom_code"
            id="custom_code"
            class="form-control"
            placeholder="Custom file name"
            readonly
          />
        </div>
      </div>
      <div class="form-group col col-sm-auto">
        <button
          class="btn btn-primary launch"
          id="launch"
          type="submit"
          name="ddt"
          value="1"
        >
          <span id="searchIcon">Launch</span>
        </button>
      </div>
    </div>
  </form>
  <div class="response">
    {% if response.error %}
    <h3>Output</h3>
    <p class="text-danger">{{response.description}}</p>
    {% elif response %}
    <h3>Output</h3>
    <p>
      Target website:
      <a href="{{response.target_url}}" target="_blank" rel="norefferer">
        {{response.target_url}}
      </a>
    </p>
    <p>Mode: {{response.attack_mode}}</p>
    <p>
      Tried variants: {{response.tried_variants}} ({{response.found_variants}}
      found)
    </p>
    {% if response.status %}
    <p>Status: <span class="text-success strong">vulnerable</span></p>
    <p>
      Summary: D&D Traversal was detected. Website is vulnerable to Directory &
      Dictionary Traversal (D&D).
    </p>
    <button
      class="btn btn-primary"
      type="button"
      data-toggle="collapse"
      data-target="#log"
      aria-expanded="false"
      aria-controls="collapseExample"
    >
      Show details
    </button>
    <div class="collapse details" id="log">
      <div class="card card-body">
        <h4>Found paths:</h4>
        <ul>
          {% for path in response.found_path %}
          <li>
            {{ forloop.counter }}.
            <a href="{{path}}" target="_blank" rel="norefferer">{{path}}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% else %}
    <p>Status: <span class="text-danger strong">not vulnerable</span>.</p>
    <p>
      Summary: D&D Traversal was not detected. Website is not vulnerable to
      Directory & Dictionary Traversal (D&D Traversal).
    </p>
    {% endif %} {% else %}
    <h3>How to use Directory & Dictionary Traversal (D&D Traversal)</h3>
    <ol>
      <li>Enter the full URL (incl. http/https)</li>
      <li>
        Choose mode
        <ul>
          <li>Full scan - perform full scan</li>
          <li>Custom file finder - scan for custom file</li>
        </ul>
      </li>
      <li>Launch D&D Traversal</li>
    </ol>
    {% endif %}
  </div>
</div>
