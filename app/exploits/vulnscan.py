import shodan
from django.http import HttpResponse

API_KEY = "eY6WEXyeE95XcmlQjARZZ4u6aO6xJGcF"

api = shodan.Shodan(API_KEY)


def search(query, facets, limit):
    # Wrap the request in a try/ except block to catch errors
    try:
        # Search Shodan
        results = api.search(query, facets=facets, limit=limit)
    except shodan.APIError as e:
        results = 'Error: {}'.format(e)
    finally:
        return results
